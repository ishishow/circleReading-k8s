# Kubernetes 環境での CI/CD

- 実際に運用を行う際には手動での kubectl コマンドの実行は可能な限り避けるべきです。

## GitOps

- GitOps とは、Git を用いた CI/CD 手法の一つです。
- Kubernetes 情にデプロイするアプリケーションを開発する際には下記のようなフローが発生します。
  - アプリケーションのソースコードを変更する。
  - アプリケーションのテストを行う
  - コンテナイメージを作成する。
  - コンテナイメージをコンテナレジストリにプッシュする
  - Deployment などのマニフェストを書き換える
  - kubectl apply 相当の処理を実行してクラスタに反映する

## GitOps に適した CI ツール

- GitOps を実現する CI ツールはアプリケーションのテスト/Docker イメージのビルド/ナブフェスとリポジトリの更新など基本的な処理が行えるものであればどのようなものでも構いません
- Kubernetes と親和性が高いツールをあげると Kubernetes の CustomResource として CI パイプラインを定義可能な Tekton と Kubernetes 上でコンテナをビルドする Kaniko を組み合わせるといった選択肢があります。

## Kubeval

- Kubeval はマニフェストファイルの YAML の構造が特定の API のバージョンに準拠しているかを検証できる OSS です。
- 例えばよくある間違いとして、Annotation の値には文字列か Null 値が必要にもかかわらず、数値を指定してしまう場合が挙げられます。こういった間違いは kkubeval によって型チェックが行われるため、事前に検出可能です。

## Conftest
